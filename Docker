Useful Commands for Docker

Show all active containers
docker ps

Show all active and non-active containers
docker ps -a

Show all images available locally
docker images

Run commands on a remote host with TLS certs
docker --tlsverify -H <IP:Port/Hostname> <command>
E.g. docker --tlsverify -H marksserver.com ps

Build image based on DockerFile in current directory
docker build .

Run an image and map container port to a port on the host machine
docker run -p <host_port>:<container_port> -d <image_id>

Additional flag for the run command to attempt to automatically restart a container 10 times on failure
--restart=on-failure:10

Stop a container
docker stop <container_name>

Remove a stopped container
docker rm <container_name>

Stop and remove all containers
docker rm -f $(docker ps -a -q)

Delete all local images
docker rmi $(docker images -q)

Delete all local containers
docker rm $(docker ps -a -q)

Save docker image to zip file
docker save -o <path for generated tar file> <image name>

Open zip file containing docker image
docker load -i <path to image tar file>

Copy a file into a docker container
docker cp hello.txt myContainerName:/dir/path/goes/here

Run a bash command inside a running container and detach
docker exec myContainerName bash -c 'echo hello'

Install and run runlike
sudo yum install -y python-pip
pip install runlike
runlike <container-name>

"Error response from daemon: client is newer than server"
export DOCKER_API_VERSION=1.23

Docker cp multiple files at once (whole db dir)
for f in /data/db/*; do docker cp $f mongo:/data/db/; done

Prune unused volumes
docker system prune --volumes (replace with --all for images etc as well)

Show last 100 lines of logs
docker logs --tail 10 <container>
